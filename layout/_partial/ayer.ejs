<% if (theme.cover.enable) { %>
<section class="cover">
    <% if (theme.github.enable && theme.github.url){ %>
      <%# "GitHub Ribbons" %>
      <a class="forkMe" href="<%=theme.github.url%>"
        target="_blank"><img src="<%- web_src('images/forkme.png') %>"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    <% } %>
  <div class="cover-frame">
    <div class="bg-box">
      <img 
        class="bg-img" 
        data="<%- list_files(theme.cover.dir, '/images/cover/') %>" 
        alt="" 
        onerror="resetBgImgSrc()"
      />
    </div>
    <div class="cover-inner text-center text-white backdrop-filter-blur-iii"
    >
      <h1><%= config.title %></h1>
      <div id="subtitle-box">
        <span id="subtitle"></span>
      </div>
      <div>
        <% if (theme.cover.logo) { %>
        <img
          src="<%- theme.cover.logo %>"
          class="cover-logo"
          alt="<%= config.title %>"
        />
        <% } %>
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>
<% } else if (theme.brand.enable) { %>
<section class="brand">
  <div class="brand-frame">
    <div class="brand-inner">
      <h1><a href="<%- url_for() %>"><%= config.title %></a></h1>
      <div id="subtitle-box">
        <span id="subtitle"></span>
      </div>
    </div>
  </div>
</section>
<% } %>

<% if (theme.subtitle.enable){ %>
<script src="https://fastly.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>
<% } %>

<!-- Subtitle -->
<% if (theme.subtitle.enable){ %>
  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: '<%= theme.subtitle.sentences %>'.split('|'),
        startDelay: Number('<%= theme.subtitle.startDelay %>'),
        typeSpeed: Number('<%= theme.subtitle.typeSpeed %>'),
        loop: Boolean('<%= theme.subtitle.loop %>'),
        backSpeed: Number('<%= theme.subtitle.backSpeed %>'),
        showCursor: Boolean('<%= theme.subtitle.showCursor %>')
      });
    } catch (err) {
      console.log(err)
    }
  </script>
<% } else { %>
  <script>
    $("#subtitle").append("<%= theme.subtitle.sentences %>".split('|').shift())
  </script>
<% } %>

<script>
  // 背景
  function resetBgImgSrc() {
    localStorage.removeItem("bg_img_src");
    loadBgImgSrc();
  }
  function loadBgImgSrc() {
    let src = localStorage.getItem("bg_img_src");
    if( src ) $(".bg-img").attr("src", src);
    else $(".bg-img").attr("src", $(".bg-img").attr("data").split(',')[0]);
  }
  loadBgImgSrc();
</script>

<script>
  // 标题图片缩放
  const $content = $(".content");
  const $cover = $(".cover");
  const $coverInner = $(".cover-inner")
  $cover.on("click", () => {
    $cover.addClass("cover__fullscreen");
    $coverInner.fadeOut(100);
    $content.one("scroll", () => {
      $cover.removeClass("cover__fullscreen");
      $coverInner.fadeIn(100);
    })
  })
</script>

<style>
  .cover__fullscreen {
    width: 100%;
    height: 100%;
    margin-top: 0;
    margin-left: 0;
    pointer-events: none;
  }
</style>